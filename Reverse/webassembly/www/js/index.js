import init, { dechiffrement_aes } from '../wasm/challenge_wa.js';

async function run() {
    await init();

    const message = document.getElementById('crypted');
    message.textContent = "117, 247, 114, 1, 112, 224, 248, 78, 180, 240, 167, 136, 167, 62, 238, 53, 241, 199, 120, 192, 121, 6, 130, 145, 188, 78, 180, 84, 44, 69, 101, 180, 148, 61, 141, 38, 105, 244, 114, 84, 84, 160, 127, 195, 247, 124, 125, 176, 33, 145, 168, 236, 67, 131, 5, 207, 37, 164, 56, 210, 7, 95, 249, 35, 31, 136, 249, 5, 108, 33, 3, 151, 89, 216, 130, 135, 131, 17, 112, 172, 187, 188, 209, 25, 103, 97, 147, 15, 145, 13, 128, 253, 213, 14, 119, 121, 19, 118, 201, 254, 228, 204, 137, 44, 145, 196, 242, 195, 121, 163, 169, 28, 71, 168, 138, 248, 28, 11, 192, 188, 111, 10, 193, 204, 219, 2, 251, 78, 77, 168, 157, 206, 44, 149, 189, 236, 32, 245, 33, 38, 5, 22, 145, 151, 175, 157, 133, 192, 32, 41, 44, 234, 51, 222, 147, 12, 70, 79, 91, 204, 167, 215, 184, 251, 234, 192, 135, 108, 246, 31, 25, 121, 60, 176, 198, 66, 174, 159, 196, 42, 213, 202, 208, 152, 145, 153, 51, 85, 249, 200, 234, 112, 61, 101, 69, 96, 247, 85, 207, 126, 135, 193, 249, 101, 10, 213, 247, 58, 55, 32, 67, 19, 237, 102, 142, 177, 70, 176, 31, 232, 117, 42, 139, 104, 44, 87, 124, 69, 187, 229, 190, 71, 70, 214, 170, 206, 154, 151, 133, 1, 40, 196, 166, 202, 145, 180, 251, 196, 178, 27, 225, 214, 106, 167, 149, 200, 89, 197, 31, 202, 141, 249, 231, 96, 209, 171, 88, 52, 147, 77, 227, 76, 87, 167, 134, 42, 167, 195, 230, 227, 84, 191, 27, 122, 126, 107, 126, 212, 204, 195, 178, 121, 234, 82, 176, 215, 137, 228, 200, 191, 230, 207, 62, 224, 137, 57, 87, 130, 17, 50, 121, 29, 122, 91, 28, 103, 6, 207, 103, 16, 150, 150, 116, 226, 113, 181, 92, 13, 42, 182, 207, 7, 218, 46, 32, 58, 146, 94, 114, 84, 112, 84, 119, 26, 164, 150, 140, 121, 211, 219, 59, 186, 224, 28, 141, 83, 91, 86, 92, 25, 204, 52, 247, 3, 193, 5, 22, 150, 100, 102, 208, 202, 144, 29, 188, 76, 201, 114, 142, 138, 220, 72, 0, 136, 65, 147, 93, 13, 138, 180, 179, 165, 114, 253, 201, 138, 243, 214, 248, 178, 96, 2, 93, 146, 254, 195, 251, 148, 56, 130, 155, 108, 207, 184, 56, 211, 87, 168, 19, 142, 83, 55, 188, 170, 95, 227, 112, 125, 220, 211, 125, 110, 43, 73, 31, 192, 69, 225, 176, 73, 188, 175, 59, 37, 75, 188, 184, 170, 56, 19, 9, 213, 162, 8, 116, 34, 174, 106, 237, 140, 75, 25, 66, 111, 233, 6, 222, 82, 119, 34, 19, 218, 162, 108, 104, 254, 91, 105, 252, 162, 11, 254, 155, 41, 28, 125, 167, 60, 254, 93, 95, 180, 74, 52, 43, 48, 41, 156, 169, 23, 131, 44, 226, 255, 89, 93, 122, 8, 29, 216, 150, 132, 12, 26, 59, 166, 81, 78, 160, 243, 224, 204, 133, 230, 236, 21, 193, 209, 59, 96, 11, 60, 176, 239, 177, 23, 238, 30, 220, 2, 161, 136, 255, 232, 83, 248, 233, 133, 70, 190, 31, 46, 26, 42, 221, 232, 94, 157, 249, 246, 211, 35, 43, 153, 60, 123, 209, 235, 71, 47, 197, 89, 81, 205, 155, 31, 128, 241, 169, 197, 201, 91, 248, 103, 66, 12, 169, 211, 50, 132, 134, 128, 122, 248, 241, 199, 213, 47, 48, 250, 157, 31, 86, 7, 68, 233, 191, 195, 192, 180, 104, 10, 199, 142, 52, 108, 118, 27, 62, 246, 246, 3, 154, 240, 47, 224, 248, 254, 255, 1, 113, 34, 100, 227, 195, 168, 146, 117, 92, 194, 48, 215, 30, 229, 27, 252, 169, 131, 167, 158, 177, 141, 99, 209, 88, 167, 206, 8, 189, 45, 3, 97, 72, 128, 42, 53, 131, 200, 235, 245, 78, 249, 199, 16, 153, 170, 80, 169, 5, 129, 51, 4, 241, 135, 9, 234, 203, 217, 177, 198, 161, 83, 132, 115, 202, 221, 186, 145, 240, 161, 84, 186, 107, 226, 111, 11, 215, 117, 132, 229, 37, 113, 243, 213, 127, 63, 3, 219, 16, 120, 186, 73, 174, 9, 127, 20, 229, 4, 24, 244, 224, 25, 3, 6, 5, 46, 13, 71, 129, 78, 106, 40, 58, 136, 50, 184, 165, 243, 62, 16, 58, 86, 230, 63, 152, 84, 68, 217, 24, 210, 109, 76, 57, 119, 53, 231, 156, 199, 148, 251, 241, 77, 187, 49, 199, 173, 14, 65, 131, 41";

    document.getElementById('decoding-form').onsubmit = function (e) {
        e.preventDefault();
        const password = document.getElementById('key').value;
        const buffer = new Uint8Array(message.textContent.split(', ').map(i => parseInt(i, 10)));
        const decrypted = dechiffrement_aes(buffer, password);
        message.textContent = decrypted;
        message.className = 'decrypted';
    }
}

run();